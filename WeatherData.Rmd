---
title: "WeatherData"
author: "Sagar Ganapaneni, Vikramjeet Singh"
date: "February 20, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
library(dplyr)
library(tidyr)
library(data.table) 


#data1 <- read.table("./daily01/2017/CRND0103-2017-AK_Barrow_4_ENE.txt")
#data2 <- read.table("./daily01/2017/CRND0103-2017-AK_Cordova_14_ESE.txt")
#data3 <- rbind(data1, data2)

#allfiles = list.files(path= "./daily01/2017", pattern="*.txt")
#flag <- 0
#read_files <- function(file_name) {
#        file <- read.table(file_name) %>% mutate(file_name = file_name) 
#        if (flag==0){
#                large_file <- file
#                flag <- 1
#        }
#        if (flag==1){
#                large_file <- rbind(large_file, file)
#        }
#}

filepath <- "./daily01/2017"
add_filename <- function(x) {
        file <- fread(x)
        file$filename <- x
        file
        }
mergefile <- function(filepath){
        filenames=list.files(path=filepath, full.names=TRUE, pattern = "\\.txt$")
        allfiles <- rbindlist(lapply(filenames, fil))
        }
allfiles = mergefile(filepath)

allfiles <- separate(data=allfiles, col=filename, into=c("a","area","c"), sep="_")
allfiles <- separate(data=allfiles, col=a, into=c("code","year","state"), sep="-")

allfiles <- allfiles[,-c("code","c")]
save(allfiles, file = "database.rda")
#split_filenames <- strsplit(allfiles, "-")
#state_area_direction <- sapply(split_state, '[[', 3)
#split_state_area_direction <- strsplit(state_area_direction, "_")
#state <- sapply(split_state_area_direction, '[[', 1)
#area <- sapply(split_state_area_direction, '[[', 2)
```

